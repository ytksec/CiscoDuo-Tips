## 一般的な２要素認証について

２要素認証といっても、認証の要素は様々あります。一般的に、認証要素としては以下があります。

+ 知識・・・パスワードなど個々のユーザーだけが知っている情報
+ 所有・・・ユーザのみが所有するもの、情報。ハードウェアトークン、モバイルアプリ(Duo Mobileなど)、電話番号(SMS)
+ 固有・・・指紋などユーザのみが持つ要素
+ ロケーション・・・ユーザがログインする場所(グローバルアドレス)
+ 時間・・・ユーザがログインする時間

主に知識、所有、固有情報の中から２要素認証を実施して、ロケーションや時間はポリシーの中で利用されている印象です。

## Duoの２要素認証

2021年1月時点で、以下の2要素認証方法に対応しており、長所、短所を記載していきます。

+ SMS
+ TOTP
+ プッシュベース
+ U2Fトークン
+ WebAuthn
+ 電話コールバック

参考：https://duo.com/product/multi-factor-authentication-mfa/two-factor-authentication-2fa

### SMS
SMSにてワンタイムパスワードが送信され、ユーザーは認証先のWebサイトまたはアプリケーションにコードを入力することで認証が完了します。

+ 長所
シンプルさ、スピード、古くから使われているため受け入れやすい

+ 短所
ユーザは電話番号を保持し、またそれを認証プロバイダに開示させる必要がある。また、SMSを受信できるデバイスを保有している必要があり、ネットワーク(電話回線)へも接続できる環境でなければならない。

### TOTP
時間ベースのワンタイムパスワード。ユーザ固有のQRコードを読み取ると時間ベースのパスコードが発行されるため、コードを入力。

+ 長所・・・
QRコードがあれば、読み取るデバイスに制限がない。また、アプリがあればデバイスはネットワークに接続している必要がない。

+ 短所・・・
ユーザがデバイスやQRコードを忘れると認証が出来ない。

### プッシュベース
Duo Mobileアプリへユーザがログインしようとしている情報（場所、時刻、IPアドレス）をプッシュ送信し、ユーザはプッシュ情報が正しい場合はアクセスを許可。

+ 長所・・・
ユーザは認証のために新たに情報を入力する必要がなく、アプリの通知の情報を確認して許可するのみ。シンプルであり、拡張性も容易。
また、SMSなどは誰でも送付することが出来るためフィッシング詐欺の対象にもなり得るが、この方式の場合はアプリのプッシュ通知のため安全。

+ 短所・・・
アプリをインストールしているモバイルデバイスがネットワークに接続している必要がある。また、ユーザがアプリのプッシュ通知の情報が正しいか確認せずに承認してしまう場合もある。

### U2Fトークン
USBトークンを使用し、ユーザは表示されたPINコードを入力する方式。

+ 長所・・・
ユーザは特別なセットアップを必要とせず、複数のデバイスで利用出来る。また、フィッシング対応にもなる。

+ 短所・・・
物理的なトークンが必要であり、紛失の可能性もある。

### WebAuthn(Web Authentication API)
FIDO（Fast IDentity Online）AllianceとW3Cによって作成されたWeb Authentication APIにより、ユーザはFIDO2準拠のデバイス(Yubikeyなど)で認証。

+ 長所・・・
一番安全な認証方式。生体情報など固有の資格情報を必要とするため、その情報が盗まれる心配が無い。iOSのFace ID/Touch IDにも対応。

+ 短所・・・
WebAuthnは特定のデバイスに設定が紐つけられており、デバイス紛失の際にはアカウント回復が困難。

### 電話コールバック
ユーザのログイン試行があると電話に着信があり、承認、拒否を電話のボタンを押して認証。

+ 長所・・・
ユーザがスマートデバイスを所持しておらず、固定電話のみという場合には有効。

+ 短所・・・
電話の着信に出る、音声を聞くなど時間を要す。電話回線が必要。
